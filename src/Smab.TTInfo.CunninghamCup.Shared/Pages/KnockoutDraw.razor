@page "/tournament/knockoutdraw"
@using Smab.TTInfo.CunninghamCup.Shared.Models

<PageTitle>Knockout Draw</PageTitle>

<h2>Knockout Draw</h2>

@if (tournament is null || tournament.KnockoutStage is null || tournament.KnockoutStage.Rounds.Count == 0)
{
    <p>No knockout stage available.</p>
}
else
{
    <h4>Knockout Players</h4>
    <ul>
        @foreach (PlayerId playerId in tournament.KnockoutStage.Rounds[0].Matches.SelectMany(m => new[] { m.PlayerA, m.PlayerB }).Distinct())
        {
            string playerName = tournament.Players.ContainsKey(playerId) ? tournament.Players[playerId].Name : playerId.ToString();
            <li>@playerName</li>
        }
    </ul>
    <button class="btn btn-success" @onclick="ConfirmKnockoutDraw">Confirm & Generate Bracket</button>
}

@code {
    [Parameter] public Tournament? tournament { get; set; }

    private void ConfirmKnockoutDraw()
    {
        // TODO: Generate bracket and navigate to KnockoutPhase page
    }
}
